mutate(research_tier_2025 = case_when(
grepl("Research 1", research_tier_2025) ~ "Research 1 (R1)",
grepl("Research 2", research_tier_2025) ~ "Research 2 (R2)",
TRUE ~ "Research Colleges and Universities"
))
# Scatter plot of research spending vs doctoral degrees
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.8, size = 3) +
scale_color_brewer(palette = "Set2") +
scale_x_continuous(labels = dollar_format()) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (FY21–FY23)",
y = "Avg. Number of Doctoral Degrees",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1)
)
# Scatter plot of research spending vs doctoral degrees
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.8, size = 3) +
scale_color_brewer(palette = "Set2") +
scale_x_continuous(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::pretty_breaks(n = 10)  # Specify more tick marks on the x-axis
) +
scale_y_continuous(
breaks = scales::pretty_breaks(n = 10)  # Specify more tick marks on the y-axis
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Billions USD)",
y = "Avg. Number of Doctoral Degrees",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",  # Position the legend below the x-axis
legend.key.width = unit(1, "cm"),  # Optionally adjust the width of the legend keys
legend.key.height = unit(0.5, "cm"),  # Optionally adjust the height of the legend keys
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))  # Set the legend to 3 columns
# Clean the spending column (remove $ and commas and convert to numeric)
clean_df_long <- combined_df %>%
mutate(
herd_avg_fy21_to_fy23 = as.numeric(gsub("[$,]", "", herd_avg_fy21_to_fy23))
)
# Optional: Rename tiers for cleaner display (if needed)
clean_df_long <- clean_df_long %>%
mutate(research_tier_2025 = case_when(
grepl("Research 1", research_tier_2025) ~ "Research 1 (R1)",
grepl("Research 2", research_tier_2025) ~ "Research 2 (R2)",
TRUE ~ "Research Colleges and Universities"
))
# Scatter plot of research spending vs doctoral degrees
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.8, size = 3) +
scale_color_brewer(palette = "Set2") +
scale_x_continuous(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::pretty_breaks(n = 10)  # Specify more tick marks on the x-axis
) +
scale_y_continuous(
breaks = scales::pretty_breaks(n = 10)  # Specify more tick marks on the y-axis
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Billions USD)",
y = "Avg. Number of Doctoral Degrees",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",  # Position the legend below the x-axis
legend.key.width = unit(1, "cm"),  # Optionally adjust the width of the legend keys
legend.key.height = unit(0.5, "cm"),  # Optionally adjust the height of the legend keys
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))  # Set the legend to 3 columns
# Clean the spending column (remove $ and commas and convert to numeric)
clean_df_long <- combined_df %>%
mutate(
herd_avg_fy21_to_fy23 = as.numeric(gsub("[$,]", "", herd_avg_fy21_to_fy23))
)
# Optional: Rename tiers for cleaner display (if needed)
clean_df_long <- clean_df_long %>%
mutate(research_tier_2025 = case_when(
grepl("Research 1", research_tier_2025) ~ "Research 1 (R1)",
grepl("Research 2", research_tier_2025) ~ "Research 2 (R2)",
TRUE ~ "Research Colleges and Universities"
))
# Scatter plot of research spending vs doctoral degrees
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.8, size = 3) +
scale_color_brewer(palette = "Set2") +
scale_x_continuous(labels = dollar_format()) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (FY21–FY23)",
y = "Avg. Number of Doctoral Degrees",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1)
)
# Clean the spending column (remove $ and commas and convert to numeric)
clean_df_long <- combined_df %>%
mutate(
herd_avg_fy21_to_fy23 = as.numeric(gsub("[$,]", "", herd_avg_fy21_to_fy23)),
herd_avg_fy21_to_fy23_billions = herd_avg_fy21_to_fy23 / 1e9  # Convert to billions
)
# Optional: Rename tiers for cleaner display (if needed)
clean_df_long <- clean_df_long %>%
mutate(research_tier_2025 = case_when(
grepl("Research 1", research_tier_2025) ~ "Research 1 (R1)",
grepl("Research 2", research_tier_2025) ~ "Research 2 (R2)",
TRUE ~ "Research Colleges and Universities"
))
# Scatter plot of research spending vs doctoral degrees
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.8, size = 3) +
scale_color_brewer(palette = "Set2") +
scale_x_continuous(
labels = scales::label_dollar(scale = 1, suffix = "B"),  # Format in billions
breaks = scales::pretty_breaks(n = 10)  # More breaks on the x-axis
) +
scale_y_continuous(
breaks = scales::pretty_breaks(n = 10)  # More breaks on the y-axis
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Billions USD)",
y = "Avg. Number of Doctoral Degrees",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",  # Position the legend below the x-axis
legend.key.width = unit(1, "cm"),  # Adjust the width of the legend keys
legend.key.height = unit(0.5, "cm"),  # Adjust the height of the legend keys
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))  # Set the legend to 3 columns
# Scatter plot of research spending vs doctoral degrees
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.8, size = 1) +
scale_color_brewer(palette = "Set2") +
scale_x_continuous(
labels = scales::label_dollar(scale = 1, suffix = "B"),  # Format in billions
breaks = scales::pretty_breaks(n = 10)  # More breaks on the x-axis
) +
scale_y_continuous(
breaks = scales::pretty_breaks(n = 10)  # More breaks on the y-axis
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Billions USD)",
y = "Avg. Number of Doctoral Degrees",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",  # Position the legend below the x-axis
legend.key.width = unit(1, "cm"),  # Adjust the width of the legend keys
legend.key.height = unit(0.5, "cm"),  # Adjust the height of the legend keys
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))  # Set the legend to 3 columns
# Scatter plot of research spending vs doctoral degrees
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.7, size = 1.5) +
scale_color_brewer(palette = "Set2") +
scale_x_continuous(
labels = scales::label_dollar(scale = 1, suffix = "B"),  # Format in billions
breaks = scales::pretty_breaks(n = 10)  # More breaks on the x-axis
) +
scale_y_continuous(
breaks = scales::pretty_breaks(n = 10)  # More breaks on the y-axis
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Billions USD)",
y = "Avg. Number of Doctoral Degrees",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",  # Position the legend below the x-axis
legend.key.width = unit(1, "cm"),  # Adjust the width of the legend keys
legend.key.height = unit(0.5, "cm"),  # Adjust the height of the legend keys
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))  # Set the legend to 3 columns
# Scatter plot of research spending vs doctoral degrees
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.8, size = 1.5) +
scale_color_brewer(palette = "Set2") +
scale_x_continuous(
labels = scales::label_dollar(scale = 1, suffix = "B"),  # Format in billions
breaks = scales::pretty_breaks(n = 10)  # More breaks on the x-axis
) +
scale_y_continuous(
breaks = scales::pretty_breaks(n = 10)  # More breaks on the y-axis
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Billions USD)",
y = "Avg. Number of Doctoral Degrees",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",  # Position the legend below the x-axis
legend.key.width = unit(1, "cm"),  # Adjust the width of the legend keys
legend.key.height = unit(0.5, "cm"),  # Adjust the height of the legend keys
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))  # Set the legend to 3 columns
# Scatter plot of research spending vs doctoral degrees
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.8, size = 1.5) +
scale_color_brewer(palette = "Set2") +
scale_x_continuous(
labels = scales::label_dollar(scale = 1, suffix = "B"),  # Format in billions
breaks = scales::pretty_breaks(n = 10)  # More breaks on the x-axis
) +
scale_y_continuous(
breaks = scales::pretty_breaks(n = 10)  # More breaks on the y-axis
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Billions USD)",
y = "Avg. Number of Doctoral Degrees",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",  # Position the legend below the x-axis
legend.key.width = unit(1, "cm"),  # Adjust the width of the legend keys
legend.key.height = unit(0.5, "cm"),  # Adjust the height of the legend keys
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))  # Set the legend to 3 columns
# Scatter plot of research spending vs doctoral degrees
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.8, size = 1.5) +
scale_color_brewer(palette = "Set2") +
scale_x_continuous(
labels = scales::label_dollar(scale = 1, suffix = "B"),  # Format in billions
breaks = scales::pretty_breaks(n = 10)  # More breaks on the x-axis
) +
scale_y_continuous(
breaks = scales::pretty_breaks(n = 10)  # More breaks on the y-axis
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Billions USD)",
y = "Avg. Number of Doctoral Degrees",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",  # Position the legend below the x-axis
legend.key.width = unit(1, "cm"),  # Adjust the width of the legend keys
legend.key.height = unit(0.5, "cm"),  # Adjust the height of the legend keys
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))  # Set the legend to 3 columns
# Clean the spending column (remove $ and commas and convert to numeric)
clean_df_long <- combined_df %>%
mutate(
herd_avg_fy21_to_fy23 = as.numeric(gsub("[$,]", "", herd_avg_fy21_to_fy23)),
herd_avg_fy21_to_fy23_billions = herd_avg_fy21_to_fy23 / 1e9  # Convert to billions
)
# Optional: Rename tiers for cleaner display (if needed)
clean_df_long <- clean_df_long %>%
mutate(research_tier_2025 = case_when(
grepl("Research 1", research_tier_2025) ~ "Research 1 (R1)",
grepl("Research 2", research_tier_2025) ~ "Research 2 (R2)",
TRUE ~ "Research Colleges and Universities"
))
# Scatter plot of research spending vs doctoral degrees
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.8, size = 1.25) +
scale_color_brewer(palette = "Set2") +
scale_x_continuous(
labels = scales::label_dollar(scale = 1, suffix = "B"),  # Format in billions
breaks = scales::pretty_breaks(n = 10)  # More breaks on the x-axis
) +
scale_y_continuous(
breaks = scales::pretty_breaks(n = 10)  # More breaks on the y-axis
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Billions USD)",
y = "Avg. Number of Doctoral Degrees",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",  # Position the legend below the x-axis
legend.key.width = unit(1, "cm"),  # Adjust the width of the legend keys
legend.key.height = unit(0.5, "cm"),  # Adjust the height of the legend keys
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))  # Set the legend to 3 columns
# Calculate average admissions rate by research tier
clean_df_long <- combined_df %>%
group_by(academic_year) %>%
mutate(total_degrees = sum(num_doc_degrees)) %>%
ungroup()
# Distribution of Size and Residential Type by Research Type
# By Mia Leandri
This grouped bar chart displays the distribution of research-designated institutions (R1, R2, and Research Colleges and Universities) across different campus size and residential categories, focusing only on 4-year universities. Institutions are categorized by size (Very Small to Large) and residential character (Highly Residential to Primarily Nonresidential), providing a detailed look at how research activity is spread across different campus environments. The chart reveals trends in how institutional research tiers align with campus scale and student living dynamics, offering insights into the structural diversity of U.S. higher education.
# Clean and reshape HERD data for all three fiscal years (FY21, FY22, FY23)
combined_df_long <- combined_df_na_cleaned %>%
select(research_tier_2025, herd_fy21, herd_fy22, herd_fy23) %>%
pivot_longer(
cols = starts_with("herd_fy"),
names_to = "fiscal_year",
values_to = "herd_spending"
) %>%
filter(!is.na(herd_spending)) %>%
mutate(
fiscal_year = recode(
fiscal_year,
herd_fy21 = "HERD Spending FY2021",
herd_fy22 = "HERD Spending FY2022",
herd_fy23 = "HERD Spending FY2023"
)
)
# Plot distribution of HERD spending for FY21, FY22, and FY23 with log scale
ggplot(combined_df_long, aes(x = herd_spending)) +
geom_histogram(bins = 20, color = "black", fill = "seagreen", alpha = 0.85) +
scale_x_log10(labels = scales::dollar_format(scale = 1e-9, suffix = "B")) +
facet_wrap(~ fiscal_year, nrow = 1, ncol = 3) + # Arrange FY21, FY22, FY23 side by side
labs(
title = "Distribution of HERD Spending for Fiscal Years 2021, 2022, and 2023",
x = "HERD Spending (Log Scale, in Billions)",
y = "Number of Institutions"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
strip.text = element_text(face = "bold"),
legend.position = "none"
)
# Clean and reshape HERD data for all three fiscal years (FY21, FY22, FY23)
combined_df_long <- combined_df_na_cleaned %>%
select(research_tier_2025, herd_fy21, herd_fy22, herd_fy23) %>%
pivot_longer(
cols = starts_with("herd_fy"),
names_to = "fiscal_year",
values_to = "herd_spending"
) %>%
filter(!is.na(herd_spending)) %>%
mutate(
fiscal_year = recode(
fiscal_year,
herd_fy21 = "HERD Spending FY2021",
herd_fy22 = "HERD Spending FY2022",
herd_fy23 = "HERD Spending FY2023"
)
)
# Plot distribution of HERD spending for FY21, FY22, and FY23 with log scale
ggplot(combined_df_long, aes(x = herd_spending)) +
geom_histogram(bins = 20, color = "black", fill = "seagreen", alpha = 0.85) +
scale_x_log10(labels = scales::dollar_format(scale = 1e-9, suffix = "B")) +
facet_wrap(~ fiscal_year, nrow = 1, ncol = 3) + # Arrange FY21, FY22, FY23 side by side
labs(
title = "Distribution of HERD Spending for Fiscal Years 2021, 2022, and 2023",
x = "HERD Spending (Log Scale, in Billions)",
y = "Number of Institutions"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
strip.text = element_text(face = "bold"),
legend.position = "none"
)
# Filter out rows with NAs in research_tier_simple or herd_spending
combined_df_long <- combined_df_na_cleaned %>%
select(research_tier_2025, herd_fy21, herd_fy22, herd_fy23) %>%
pivot_longer(
cols = starts_with("herd_fy"),
names_to = "fiscal_year",
values_to = "herd_spending"
) %>%
filter(!is.na(herd_spending), !is.na(research_tier_2025)) %>%
mutate(
fiscal_year = recode(
fiscal_year,
herd_fy21 = "HERD Spending FY2021",
herd_fy22 = "HERD Spending FY2022",
herd_fy23 = "HERD Spending FY2023"
),
# Simplify research tier labels
research_tier_simple = recode(
research_tier_2025,
"Research 1: Very High Research Spending and Doctorate Production" = "Research 1",
"Research 2: High Research Spending and Doctorate Production" = "Research 2",
"Research Colleges and Universities" = "Research Colleges and Universities"
)
) %>%
filter(!is.na(research_tier_simple), !is.na(herd_spending))  # Remove NAs
# Plot with simplified legend labels and without NAs
ggplot(combined_df_long, aes(x = herd_spending, fill = research_tier_simple)) +
geom_histogram(bins = 30, color = "black", alpha = 0.8, position = "identity") +
scale_x_log10(labels = scales::dollar_format(scale = 1e-9, suffix = "B")) +
facet_wrap(~ fiscal_year, nrow = 1, ncol = 3) +
scale_fill_manual(
values = c(
"Research 1" = brewer.pal(3, "Set2")[1],
"Research 2" = brewer.pal(3, "Set2")[2],
"Research Colleges and Universities" = brewer.pal(3, "Set2")[3]
),
labels = c("Research 1", "Research 2", "Research Colleges and Universities")  # Simplify the legend labels
) +
labs(
title = "HERD Spending by Fiscal Year and Research Tier (Log Scale)",
subtitle = "Excludes institutions without a research designation",
x = "HERD Spending (Log Scale, in Billions)",
y = "Number of Institutions",
fill = "Research Tier",
caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, face = "bold"),
plot.subtitle = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0.5, size = 9),
strip.text = element_text(face = "bold"),
legend.position = "bottom",
legend.direction = "horizontal"
)
