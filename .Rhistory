y = "Density",
caption = "Note: 'Research Colleges and Universities' (RCU) are research-focused but do not meet R1 or R2 criteria for expenses and/or doctoral degrees conferred.\nData source: Carnegie Classification of Institutions of Higher Education (https://carnegieclassifications.acenet.edu)"
) +
my_plot_theme +
theme(
plot.title = element_text(hjust = 0, face = "bold"),
strip.text = element_text(face = "bold"),
legend.position = "none",
panel.grid.major = element_blank()
)
# Plot with the cleaned data
ggplot(combined_df_long_cleaned, aes(x = herd_spending)) +
geom_histogram(aes(y = ..density..), bins = 20, color = "black", fill = "yellow", alpha = 0.9, size = 0.3) +
geom_density(color = "darkred", size = 1, linetype = "solid") +
scale_x_log10(labels = scales::dollar_format(scale = 1e-9, suffix = "B")) +
facet_wrap(~ fiscal_year, nrow = 1, ncol = 3) +  # Arrange FY21, FY22, FY23 side by side
labs(
title = "Distribution of Spending in Higher Education Research and Development (HERD)",
x = "HERD Spending (Log Scale, in Billions)",
y = "Density",
caption = "Note: 'Research Colleges and Universities' (RCU) are research-focused but do not meet R1 or R2 criteria for expenses and/or doctoral degrees conferred.\nData source: Carnegie Classification of Institutions of Higher Education (https://carnegieclassifications.acenet.edu)"
) +
my_plot_theme +
theme(
plot.title = element_text(hjust = 0, face = "bold"),
strip.text = element_text(face = "bold"),
legend.position = "none",
panel.grid.major = element_blank()
)
# Plot with the cleaned data
ggplot(combined_df_long_cleaned, aes(x = herd_spending)) +
geom_histogram(aes(y = ..density..), bins = 20, color = "black", fill = "yellow", alpha = 0.7, size = 0.3) +
geom_density(color = "darkred", size = 1, linetype = "solid") +
scale_x_log10(labels = scales::dollar_format(scale = 1e-9, suffix = "B")) +
facet_wrap(~ fiscal_year, nrow = 1, ncol = 3) +  # Arrange FY21, FY22, FY23 side by side
labs(
title = "Distribution of Spending in Higher Education Research and Development (HERD)",
x = "HERD Spending (Log Scale, in Billions)",
y = "Density",
caption = "Note: 'Research Colleges and Universities' (RCU) are research-focused but do not meet R1 or R2 criteria for expenses and/or doctoral degrees conferred.\nData source: Carnegie Classification of Institutions of Higher Education (https://carnegieclassifications.acenet.edu)"
) +
my_plot_theme +
theme(
plot.title = element_text(hjust = 0, face = "bold"),
strip.text = element_text(face = "bold"),
legend.position = "none",
panel.grid.major = element_blank()
)
# Plot with the cleaned data
ggplot(combined_df_long_cleaned, aes(x = herd_spending)) +
geom_histogram(aes(y = ..density..), bins = 20, color = "black", fill = "yellow", alpha = 0.5, size = 0.3) +
geom_density(color = "darkred", size = 1, linetype = "solid") +
scale_x_log10(labels = scales::dollar_format(scale = 1e-9, suffix = "B")) +
facet_wrap(~ fiscal_year, nrow = 1, ncol = 3) +  # Arrange FY21, FY22, FY23 side by side
labs(
title = "Distribution of Spending in Higher Education Research and Development (HERD)",
x = "HERD Spending (Log Scale, in Billions)",
y = "Density",
caption = "Note: 'Research Colleges and Universities' (RCU) are research-focused but do not meet R1 or R2 criteria for expenses and/or doctoral degrees conferred.\nData source: Carnegie Classification of Institutions of Higher Education (https://carnegieclassifications.acenet.edu)"
) +
my_plot_theme +
theme(
plot.title = element_text(hjust = 0, face = "bold"),
strip.text = element_text(face = "bold"),
legend.position = "none",
panel.grid.major = element_blank()
)
# Plot with the cleaned data
ggplot(combined_df_long_cleaned, aes(x = herd_spending)) +
geom_histogram(aes(y = ..density..), bins = 20, color = "black", fill = "navy", alpha = 0.5, size = 0.3) +
geom_density(color = "darkred", size = 1, linetype = "solid") +
scale_x_log10(labels = scales::dollar_format(scale = 1e-9, suffix = "B")) +
facet_wrap(~ fiscal_year, nrow = 1, ncol = 3) +  # Arrange FY21, FY22, FY23 side by side
labs(
title = "Distribution of Spending in Higher Education Research and Development (HERD)",
x = "HERD Spending (Log Scale, in Billions)",
y = "Density",
caption = "Note: 'Research Colleges and Universities' (RCU) are research-focused but do not meet R1 or R2 criteria for expenses and/or doctoral degrees conferred.\nData source: Carnegie Classification of Institutions of Higher Education (https://carnegieclassifications.acenet.edu)"
) +
my_plot_theme +
theme(
plot.title = element_text(hjust = 0, face = "bold"),
strip.text = element_text(face = "bold"),
legend.position = "none",
panel.grid.major = element_blank()
)
# Plot with the cleaned data
ggplot(combined_df_long_cleaned, aes(x = herd_spending)) +
geom_histogram(aes(y = ..density..), bins = 20, color = "black", fill = "lightblue", alpha = 0.5, size = 0.3) +
geom_density(color = "darkred", size = 1, linetype = "solid") +
scale_x_log10(labels = scales::dollar_format(scale = 1e-9, suffix = "B")) +
facet_wrap(~ fiscal_year, nrow = 1, ncol = 3) +  # Arrange FY21, FY22, FY23 side by side
labs(
title = "Distribution of Spending in Higher Education Research and Development (HERD)",
x = "HERD Spending (Log Scale, in Billions)",
y = "Density",
caption = "Note: 'Research Colleges and Universities' (RCU) are research-focused but do not meet R1 or R2 criteria for expenses and/or doctoral degrees conferred.\nData source: Carnegie Classification of Institutions of Higher Education (https://carnegieclassifications.acenet.edu)"
) +
my_plot_theme +
theme(
plot.title = element_text(hjust = 0, face = "bold"),
strip.text = element_text(face = "bold"),
legend.position = "none",
panel.grid.major = element_blank()
)
# Plot with the cleaned data
ggplot(combined_df_long_cleaned, aes(x = herd_spending)) +
geom_histogram(aes(y = ..density..), bins = 20, color = "black", fill = "skyblue", alpha = 0.5, size = 0.3) +
geom_density(color = "darkred", size = 1, linetype = "solid") +
scale_x_log10(labels = scales::dollar_format(scale = 1e-9, suffix = "B")) +
facet_wrap(~ fiscal_year, nrow = 1, ncol = 3) +  # Arrange FY21, FY22, FY23 side by side
labs(
title = "Distribution of Spending in Higher Education Research and Development (HERD)",
x = "HERD Spending (Log Scale, in Billions)",
y = "Density",
caption = "Note: 'Research Colleges and Universities' (RCU) are research-focused but do not meet R1 or R2 criteria for expenses and/or doctoral degrees conferred.\nData source: Carnegie Classification of Institutions of Higher Education (https://carnegieclassifications.acenet.edu)"
) +
my_plot_theme +
theme(
plot.title = element_text(hjust = 0, face = "bold"),
strip.text = element_text(face = "bold"),
legend.position = "none",
panel.grid.major = element_blank()
)
# Plot with the cleaned data
ggplot(combined_df_long_cleaned, aes(x = herd_spending)) +
geom_histogram(aes(y = ..density..), bins = 20, color = "black", fill = "skyblue", alpha = 0.7, size = 0.3) +
geom_density(color = "darkred", size = 1, linetype = "solid") +
scale_x_log10(labels = scales::dollar_format(scale = 1e-9, suffix = "B")) +
facet_wrap(~ fiscal_year, nrow = 1, ncol = 3) +  # Arrange FY21, FY22, FY23 side by side
labs(
title = "Distribution of Spending in Higher Education Research and Development (HERD)",
x = "HERD Spending (Log Scale, in Billions)",
y = "Density",
caption = "Note: 'Research Colleges and Universities' (RCU) are research-focused but do not meet R1 or R2 criteria for expenses and/or doctoral degrees conferred.\nData source: Carnegie Classification of Institutions of Higher Education (https://carnegieclassifications.acenet.edu)"
) +
my_plot_theme +
theme(
plot.title = element_text(hjust = 0, face = "bold"),
strip.text = element_text(face = "bold"),
legend.position = "none",
panel.grid.major = element_blank()
)
# 7.Higher Education Research and Development (HERD) Spending by Fiscal Year and Research Tier
# By Lily Gates
# Clean and reshape data
combined_df_long <- combined_df_na_cleaned %>%
select(research_tier_2025, herd_fy21, herd_fy22, herd_fy23) %>%
pivot_longer(
cols = starts_with("herd_fy"),
names_to = "fiscal_year",
values_to = "herd_spending"
) %>%
filter(!is.na(herd_spending), !is.na(research_tier_2025)) %>%
mutate(
fiscal_year = recode(
fiscal_year,
herd_fy21 = "FY 2021",
herd_fy22 = "FY 2022",
herd_fy23 = "FY 2023"
),
research_tier_simple = recode(
research_tier_2025,
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2",
"Research Colleges and Universities" = "RCU"
)
) %>%
filter(herd_spending > 0)
# Hardcoded color-blind friendly colors
color_mapping <- c(
"R1" = "#E69F00",  # orange
"R2" = "#56B4E9",  # blue
"RCU" = "#009E73"  # green
)
# Plot
ggplot(combined_df_long, aes(x = herd_spending, color = research_tier_simple, fill = research_tier_simple)) +
geom_density(alpha = 0.3, size = .7) +
scale_x_log10(labels = dollar_format(scale = 1e-9, suffix = "B")) +
facet_wrap(~ fiscal_year, nrow = 1) +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
labs(
title = "Higher Education Research and Development (HERD)\nSpending by Fiscal Year and Research Tier",
x = "HERD Spending (Log Scale, in Billions)",
y = "Density",
color = "",
fill = "",
caption = "Note: 'Research Colleges and Universities' (RCU) are research-focused but do not meet R1 or R2 criteria for expenses and/or doctoral degrees conferred.\nData source: Carnegie Classification of Institutions of Higher Education (https://carnegieclassifications.acenet.edu)"
) +
my_plot_theme +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 15),
plot.subtitle = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0, size = 9),
strip.text = element_text(face = "bold"),
legend.position = "bottom",
legend.direction = "horizontal",
panel.grid.major = element_blank()
)
# Plot
ggplot(combined_df_long, aes(x = herd_spending, color = research_tier_simple, fill = research_tier_simple)) +
geom_density(alpha = 0.3, size = .5) +
scale_x_log10(labels = dollar_format(scale = 1e-9, suffix = "B")) +
facet_wrap(~ fiscal_year, nrow = 1) +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
labs(
title = "Higher Education Research and Development (HERD)\nSpending by Fiscal Year and Research Tier",
x = "HERD Spending (Log Scale, in Billions)",
y = "Density",
color = "",
fill = "",
caption = "Note: 'Research Colleges and Universities' (RCU) are research-focused but do not meet R1 or R2 criteria for expenses and/or doctoral degrees conferred.\nData source: Carnegie Classification of Institutions of Higher Education (https://carnegieclassifications.acenet.edu)"
) +
my_plot_theme +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 15),
plot.subtitle = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0, size = 9),
strip.text = element_text(face = "bold"),
legend.position = "bottom",
legend.direction = "horizontal",
panel.grid.major = element_blank()
)
# Plot
ggplot(combined_df_long, aes(x = herd_spending, color = research_tier_simple, fill = research_tier_simple)) +
geom_density(alpha = 0.3, size = .8) +
scale_x_log10(labels = dollar_format(scale = 1e-9, suffix = "B")) +
facet_wrap(~ fiscal_year, nrow = 1) +
scale_color_manual(values = color_mapping) +
scale_fill_manual(values = color_mapping) +
labs(
title = "Higher Education Research and Development (HERD)\nSpending by Fiscal Year and Research Tier",
x = "HERD Spending (Log Scale, in Billions)",
y = "Density",
color = "",
fill = "",
caption = "Note: 'Research Colleges and Universities' (RCU) are research-focused but do not meet R1 or R2 criteria for expenses and/or doctoral degrees conferred.\nData source: Carnegie Classification of Institutions of Higher Education (https://carnegieclassifications.acenet.edu)"
) +
my_plot_theme +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 15),
plot.subtitle = element_text(hjust = 0.5),
plot.caption = element_text(hjust = 0, size = 9),
strip.text = element_text(face = "bold"),
legend.position = "bottom",
legend.direction = "horizontal",
panel.grid.major = element_blank()
)
ggplot(clean_df_long_filtered, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
# Scatter points
geom_point(alpha = 0.6, size = 1.2) +
scale_color_manual(
values = custom_colors,
guide = guide_legend(override.aes = list(size = 4))
) +
# Regression line (explicit x/y mapping)
geom_line(
data = clean_df_long_filtered,
aes(x = herd_avg_fy21_to_fy23_billions, y = predicted_line),
inherit.aes = FALSE,
color = "gray30",
size = 1
) +
# Confidence ribbon (gray fill, no color mapping)
geom_ribbon(
data = clean_df_long_filtered,
aes(x = herd_avg_fy21_to_fy23_billions, ymin = ci_lower, ymax = ci_upper),
inherit.aes = FALSE,
fill = "gray30",
alpha = 0.3
) +
# Upper CI dashed line
geom_line(
data = clean_df_long_filtered,
aes(x = herd_avg_fy21_to_fy23_billions, y = ci_upper),
inherit.aes = FALSE,
color = "gray30",
linetype = "dashed",
size = 0.3
) +
# Lower CI dashed line
geom_line(
data = clean_df_long_filtered,
aes(x = herd_avg_fy21_to_fy23_billions, y = ci_lower),
inherit.aes = FALSE,
color = "gray30",
linetype = "dashed",
size = 0.3
) +
# Axes
scale_x_log10(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::log_breaks()
) +
scale_y_log10(
breaks = scales::log_breaks(),
limits = c(1, NA)
) +
# Labels
labs(
title = "Positive Correlation Between Research Spending and Doctoral Degrees",
subtitle = "Comparing average spending from 2020 to 2023",
x = "Avg. Research Spending\n(Log Scale, Billions USD)",
y = "Avg. Number of Doctoral Degrees\n(Log Scale)",
color = ""
) +
# Theme
my_plot_theme +
theme(
legend.position = "bottom",
legend.justification = "center",
legend.box = "horizontal",
legend.margin = margin(t = 5),  # Adds space between plot and legend
plot.margin = margin(t = 10, r = 10, b = 10, l = 10)  # Optional: adjust bottom space
) +
#   # Use annotate() for the regression equation and R-squared annotation with an outline
annotate(
"label",
x = 0.15,
y = 2,
label = paste0("y = ", round(449.76, 2), "x + ", round(52.28, 2), "\nR² = ", round(0.85, 2)),
color = "black",
fill = alpha("white", 0.3),  # White background with 70% opacity
size = 5,
hjust = 0,
fontface = "italic",
label.size = 0.6,  # Outline size (change to control thickness)
label.padding = unit(0.45, "lines"),  # Adjust padding to add space around text
label.r = unit(0.4, "lines")  # Adjust the radius of the label corners
)
# 7.Higher Education Research and Development (HERD) Spending by Fiscal Year and Research Tier
By Lily Gates
# 8. Average Research Spending vs. Doctoral Degrees (2020–2023) by Research Tier
By Mia Leandri
ggplot(clean_df_long_filtered, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
# Scatter points
geom_point(alpha = 0.6, size = 1.2) +
scale_color_manual(
values = custom_colors,
guide = guide_legend(override.aes = list(size = 4))
) +
# Regression line (explicit x/y mapping)
geom_line(
data = clean_df_long_filtered,
aes(x = herd_avg_fy21_to_fy23_billions, y = predicted_line),
inherit.aes = FALSE,
color = "gray30",
size = 1
) +
# Confidence ribbon (gray fill, no color mapping)
geom_ribbon(
data = clean_df_long_filtered,
aes(x = herd_avg_fy21_to_fy23_billions, ymin = ci_lower, ymax = ci_upper),
inherit.aes = FALSE,
fill = "gray30",
alpha = 0.3
) +
# Upper CI dashed line
geom_line(
data = clean_df_long_filtered,
aes(x = herd_avg_fy21_to_fy23_billions, y = ci_upper),
inherit.aes = FALSE,
color = "gray30",
linetype = "dashed",
size = 0.3
) +
# Lower CI dashed line
geom_line(
data = clean_df_long_filtered,
aes(x = herd_avg_fy21_to_fy23_billions, y = ci_lower),
inherit.aes = FALSE,
color = "gray30",
linetype = "dashed",
size = 0.3
) +
# Axes
scale_x_log10(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::log_breaks()
) +
scale_y_log10(
breaks = scales::log_breaks(),
limits = c(1, NA)
) +
# Labels
labs(
title = "Positive Correlation Between Research Spending and Doctoral Degrees",
subtitle = "Comparing average spending from 2020 to 2023",
x = "Avg. Research Spending\n(Log Scale, Billions USD)",
y = "Avg. Number of Doctoral Degrees\n(Log Scale)",
color = ""
) +
# Theme
my_plot_theme +
theme(
legend.position = "bottom",
legend.justification = "center",
legend.box = "horizontal",
legend.margin = margin(t = 5),  # Adds space between plot and legend
plot.margin = margin(t = 10, r = 10, b = 10, l = 10)  # Optional: adjust bottom space
) +
#   # Use annotate() for the regression equation and R-squared annotation with an outline
annotate(
"label",
x = 0.15,
y = 2,
label = paste0("y = ", round(449.76, 2), "x + ", round(52.28, 2), "\nR² = ", round(0.85, 2)),
color = "black",
fill = alpha("white", 0.3),  # White background with 70% opacity
size = 5,
hjust = 0,
fontface = "italic",
label.size = 0.6,  # Outline size (change to control thickness)
label.padding = unit(0.45, "lines"),  # Adjust padding to add space around text
label.r = unit(0.4, "lines")  # Adjust the radius of the label corners
)
ggplot(clean_df_long_filtered, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
# Scatter points
geom_point(alpha = 0.6, size = 1.2) +
scale_color_manual(
values = custom_colors,
guide = guide_legend(override.aes = list(size = 4))
) +
# Regression line (explicit x/y mapping)
geom_line(
data = clean_df_long_filtered,
aes(x = herd_avg_fy21_to_fy23_billions, y = predicted_line),
inherit.aes = FALSE,
color = "gray30",
size = 1
) +
# Confidence ribbon (gray fill, no color mapping)
geom_ribbon(
data = clean_df_long_filtered,
aes(x = herd_avg_fy21_to_fy23_billions, ymin = ci_lower, ymax = ci_upper),
inherit.aes = FALSE,
fill = "black",
alpha = 0.3
) +
# Upper CI dashed line
geom_line(
data = clean_df_long_filtered,
aes(x = herd_avg_fy21_to_fy23_billions, y = ci_upper),
inherit.aes = FALSE,
color = "gray30",
linetype = "dashed",
size = 0.3
) +
# Lower CI dashed line
geom_line(
data = clean_df_long_filtered,
aes(x = herd_avg_fy21_to_fy23_billions, y = ci_lower),
inherit.aes = FALSE,
color = "gray30",
linetype = "dashed",
size = 0.3
) +
# Axes
scale_x_log10(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::log_breaks()
) +
scale_y_log10(
breaks = scales::log_breaks(),
limits = c(1, NA)
) +
# Labels
labs(
title = "Positive Correlation Between Research Spending and Doctoral Degrees",
subtitle = "Comparing average spending from 2020 to 2023",
x = "Avg. Research Spending\n(Log Scale, Billions USD)",
y = "Avg. Number of Doctoral Degrees\n(Log Scale)",
color = ""
) +
# Theme
my_plot_theme +
theme(
legend.position = "bottom",
legend.justification = "center",
legend.box = "horizontal",
legend.margin = margin(t = 5),  # Adds space between plot and legend
plot.margin = margin(t = 10, r = 10, b = 10, l = 10)  # Optional: adjust bottom space
) +
#   # Use annotate() for the regression equation and R-squared annotation with an outline
annotate(
"label",
x = 0.15,
y = 2,
label = paste0("y = ", round(449.76, 2), "x + ", round(52.28, 2), "\nR² = ", round(0.85, 2)),
color = "black",
fill = alpha("white", 0.3),  # White background with 70% opacity
size = 5,
hjust = 0,
fontface = "italic",
label.size = 0.6,  # Outline size (change to control thickness)
label.padding = unit(0.45, "lines"),  # Adjust padding to add space around text
label.r = unit(0.4, "lines")  # Adjust the radius of the label corners
)
