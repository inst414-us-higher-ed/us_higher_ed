caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
scale_x_discrete(labels = c(
"Public" = "Public",
"Private non-profit" = "Private (non-profit)",
"Private for-profit" = "Private (for-profit)"
)) +
scale_y_continuous(limits = c(0, 150), expand = c(0, 0)) +
scale_fill_manual(
values = c(
"Research Colleges and Universities" = "plum",  # Research Colleges stand out
"Research 1: Very High Research Spending and Doctorate Production" = "teal",  # R1 color
"Research 2: High Research Spending and Doctorate Production" = "steelblue"  # R2 color
),
labels = c(
"Research Colleges and Universities" = "Research Colleges\nand Universities",
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2"
)
) +
theme(
axis.text.y = element_text(size = 10),
legend.position = "bottom",  # Move the legend to the bottom
legend.box = "horizontal",   # Makes the legend horizontal
legend.title = element_text(size = 12),  # Adding legend title size
axis.text.x = element_text(angle = 0, hjust = 0.5)  # Set x-axis labels to 0 degrees (normal)
)
# Create the plot
ggplot(plot_df_clean, aes(x = public_private_profit, y = n, fill = research_tier_2025)) +
geom_bar(position = "dodge", stat = "identity", width = 0.7) +  # Adjust width for equal bar widths
labs(
title = "Count of Institutions by Type and Research Activity Designation (2025)",
subtitle = "Excludes institutions without a research designation",
x = "Institution Type",
y = "Count of Institutions",
fill = "Research Activity Designation",
caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
scale_x_discrete(labels = c(
"Public" = "Public",
"Private non-profit" = "Private (non-profit)",
"Private for-profit" = "Private (for-profit)"
)) +
scale_y_continuous(limits = c(0, 150), expand = c(0, 0)) +
scale_fill_manual(
values = c(
"Research Colleges and Universities" = "plum",  # Research Colleges stand out
"Research 1: Very High Research Spending and Doctorate Production" = "lightseagreen",  # R1 color
"Research 2: High Research Spending and Doctorate Production" = "steelblue"  # R2 color
),
labels = c(
"Research Colleges and Universities" = "Research Colleges\nand Universities",
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2"
)
) +
theme(
axis.text.y = element_text(size = 10),
legend.position = "bottom",  # Move the legend to the bottom
legend.box = "horizontal",   # Makes the legend horizontal
legend.title = element_text(size = 12),  # Adding legend title size
axis.text.x = element_text(angle = 0, hjust = 0.5)  # Set x-axis labels to 0 degrees (normal)
)
# Create the plot
ggplot(plot_df_clean, aes(x = public_private_profit, y = n, fill = research_tier_2025)) +
geom_bar(position = "dodge", stat = "identity", width = 0.7) +  # Adjust width for equal bar widths
labs(
title = "Count of Institutions by Type and Research Activity Designation (2025)",
subtitle = "Excludes institutions without a research designation",
x = "Institution Type",
y = "Count of Institutions",
fill = "Research Activity Designation",
caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
scale_x_discrete(labels = c(
"Public" = "Public",
"Private non-profit" = "Private (non-profit)",
"Private for-profit" = "Private (for-profit)"
)) +
scale_y_continuous(limits = c(0, 150), expand = c(0, 0)) +
scale_fill_manual(
values = c(
"Research Colleges and Universities" = "plum",  # Research Colleges stand out
"Research 1: Very High Research Spending and Doctorate Production" = "lightseagreen",  # R1 color
"Research 2: High Research Spending and Doctorate Production" = "cadetblue"  # R2 color
),
labels = c(
"Research Colleges and Universities" = "Research Colleges\nand Universities",
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2"
)
) +
theme(
axis.text.y = element_text(size = 10),
legend.position = "bottom",  # Move the legend to the bottom
legend.box = "horizontal",   # Makes the legend horizontal
legend.title = element_text(size = 12),  # Adding legend title size
axis.text.x = element_text(angle = 0, hjust = 0.5)  # Set x-axis labels to 0 degrees (normal)
)
# Create the plot
ggplot(plot_df_clean, aes(x = public_private_profit, y = n, fill = research_tier_2025)) +
geom_bar(position = "dodge", stat = "identity", width = 0.7) +  # Adjust width for equal bar widths
labs(
title = "Count of Institutions by Type and Research Activity Designation (2025)",
subtitle = "Excludes institutions without a research designation",
x = "Institution Type",
y = "Count of Institutions",
fill = "Research Activity Designation",
caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
scale_x_discrete(labels = c(
"Public" = "Public",
"Private non-profit" = "Private (non-profit)",
"Private for-profit" = "Private (for-profit)"
)) +
scale_y_continuous(limits = c(0, 150), expand = c(0, 0)) +
scale_fill_manual(
values = c(
"Research Colleges and Universities" = "plum",  # Research Colleges stand out
"Research 1: Very High Research Spending and Doctorate Production" = "lightseagreen",  # R1 color
"Research 2: High Research Spending and Doctorate Production" = "steelblue"  # R2 color
),
labels = c(
"Research Colleges and Universities" = "Research Colleges\nand Universities",
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2"
)
) +
theme(
axis.text.y = element_text(size = 10),
legend.position = "bottom",  # Move the legend to the bottom
legend.box = "horizontal",   # Makes the legend horizontal
legend.title = element_text(size = 12),  # Adding legend title size
axis.text.x = element_text(angle = 0, hjust = 0.5)  # Set x-axis labels to 0 degrees (normal)
)
# Create the plot
ggplot(plot_df_clean, aes(x = public_private_profit, y = n, fill = research_tier_2025)) +
geom_bar(position = "dodge", stat = "identity", width = 0.7) +  # Adjust width for equal bar widths
labs(
title = "Count of Institutions by Type and Research Activity Designation (2025)",
subtitle = "Excludes institutions without a research designation",
x = "Institution Type",
y = "Count of Institutions",
fill = "Research Activity Designation",
caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
scale_x_discrete(labels = c(
"Public" = "Public",
"Private non-profit" = "Private (non-profit)",
"Private for-profit" = "Private (for-profit)"
)) +
scale_y_continuous(limits = c(0, 150), expand = c(0, 0)) +
scale_fill_manual(
values = c(
"Research Colleges and Universities" = "plum",  # Research Colleges stand out
"Research 1: Very High Research Spending and Doctorate Production" = "dodgerblue",  # R1 color
"Research 2: High Research Spending and Doctorate Production" = "steelblue"  # R2 color
),
labels = c(
"Research Colleges and Universities" = "Research Colleges\nand Universities",
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2"
)
) +
theme(
axis.text.y = element_text(size = 10),
legend.position = "bottom",  # Move the legend to the bottom
legend.box = "horizontal",   # Makes the legend horizontal
legend.title = element_text(size = 12),  # Adding legend title size
axis.text.x = element_text(angle = 0, hjust = 0.5)  # Set x-axis labels to 0 degrees (normal)
)
# Create the plot
ggplot(plot_df_clean, aes(x = public_private_profit, y = n, fill = research_tier_2025)) +
geom_bar(position = "dodge", stat = "identity", width = 0.7) +  # Adjust width for equal bar widths
labs(
title = "Count of Institutions by Type and Research Activity Designation (2025)",
subtitle = "Excludes institutions without a research designation",
x = "Institution Type",
y = "Count of Institutions",
fill = "Research Activity Designation",
caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
scale_x_discrete(labels = c(
"Public" = "Public",
"Private non-profit" = "Private (non-profit)",
"Private for-profit" = "Private (for-profit)"
)) +
scale_y_continuous(limits = c(0, 150), expand = c(0, 0)) +
scale_fill_manual(
values = c(
"Research Colleges and Universities" = "plum",  # Research Colleges stand out
"Research 1: Very High Research Spending and Doctorate Production" = "darkcyan",  # R1 color
"Research 2: High Research Spending and Doctorate Production" = "steelblue"  # R2 color
),
labels = c(
"Research Colleges and Universities" = "Research Colleges\nand Universities",
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2"
)
) +
theme(
axis.text.y = element_text(size = 10),
legend.position = "bottom",  # Move the legend to the bottom
legend.box = "horizontal",   # Makes the legend horizontal
legend.title = element_text(size = 12),  # Adding legend title size
axis.text.x = element_text(angle = 0, hjust = 0.5)  # Set x-axis labels to 0 degrees (normal)
)
# Create the plot
ggplot(plot_df_clean, aes(x = public_private_profit, y = n, fill = research_tier_2025)) +
geom_bar(position = "dodge", stat = "identity", width = 0.7) +  # Adjust width for equal bar widths
labs(
title = "Count of Institutions by Type and Research Activity Designation (2025)",
subtitle = "Excludes institutions without a research designation",
x = "Institution Type",
y = "Count of Institutions",
fill = "Research Activity Designation",
caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
scale_x_discrete(labels = c(
"Public" = "Public",
"Private non-profit" = "Private (non-profit)",
"Private for-profit" = "Private (for-profit)"
)) +
scale_y_continuous(limits = c(0, 150), expand = c(0, 0)) +
scale_fill_manual(
values = c(
"Research Colleges and Universities" = "thistle",  # Research Colleges stand out
"Research 1: Very High Research Spending and Doctorate Production" = "royalblue",  # R1 color
"Research 2: High Research Spending and Doctorate Production" = "cornflowerblue"  # R2 color
),
labels = c(
"Research Colleges and Universities" = "Research Colleges\nand Universities",
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2"
)
) +
theme(
axis.text.y = element_text(size = 10),
legend.position = "bottom",  # Move the legend to the bottom
legend.box = "horizontal",   # Makes the legend horizontal
legend.title = element_text(size = 12),  # Adding legend title size
axis.text.x = element_text(angle = 0, hjust = 0.5)  # Set x-axis labels to 0 degrees (normal)
)
# Create the plot
ggplot(plot_df_clean, aes(x = public_private_profit, y = n, fill = research_tier_2025)) +
geom_bar(position = "dodge", stat = "identity", width = 0.7) +  # Adjust width for equal bar widths
labs(
title = "Count of Institutions by Type and Research Activity Designation (2025)",
subtitle = "Excludes institutions without a research designation",
x = "Institution Type",
y = "Count of Institutions",
fill = "Research Activity Designation",
caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
scale_x_discrete(labels = c(
"Public" = "Public",
"Private non-profit" = "Private (non-profit)",
"Private for-profit" = "Private (for-profit)"
)) +
scale_y_continuous(limits = c(0, 150), expand = c(0, 0)) +
scale_fill_manual(
values = c(
"Research Colleges and Universities" = "orchid",  # Research Colleges stand out
"Research 1: Very High Research Spending and Doctorate Production" = "royalblue",  # R1 color
"Research 2: High Research Spending and Doctorate Production" = "cornflowerblue"  # R2 color
),
labels = c(
"Research Colleges and Universities" = "Research Colleges\nand Universities",
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2"
)
) +
theme(
axis.text.y = element_text(size = 10),
legend.position = "bottom",  # Move the legend to the bottom
legend.box = "horizontal",   # Makes the legend horizontal
legend.title = element_text(size = 12),  # Adding legend title size
axis.text.x = element_text(angle = 0, hjust = 0.5)  # Set x-axis labels to 0 degrees (normal)
)
# Create the plot
ggplot(plot_df_clean, aes(x = public_private_profit, y = n, fill = research_tier_2025)) +
geom_bar(position = "dodge", stat = "identity", width = 0.7) +  # Adjust width for equal bar widths
labs(
title = "Count of Institutions by Type and Research Activity Designation (2025)",
subtitle = "Excludes institutions without a research designation",
x = "Institution Type",
y = "Count of Institutions",
fill = "Research Activity Designation",
caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
scale_x_discrete(labels = c(
"Public" = "Public",
"Private non-profit" = "Private (non-profit)",
"Private for-profit" = "Private (for-profit)"
)) +
scale_y_continuous(limits = c(0, 150), expand = c(0, 0)) +
scale_fill_manual(
values = c(
"Research Colleges and Universities" = "palevioletred",  # Research Colleges stand out
"Research 1: Very High Research Spending and Doctorate Production" = "royalblue",  # R1 color
"Research 2: High Research Spending and Doctorate Production" = "cornflowerblue"  # R2 color
),
labels = c(
"Research Colleges and Universities" = "Research Colleges\nand Universities",
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2"
)
) +
theme(
axis.text.y = element_text(size = 10),
legend.position = "bottom",  # Move the legend to the bottom
legend.box = "horizontal",   # Makes the legend horizontal
legend.title = element_text(size = 12),  # Adding legend title size
axis.text.x = element_text(angle = 0, hjust = 0.5)  # Set x-axis labels to 0 degrees (normal)
)
# Create the plot
ggplot(plot_df_clean, aes(x = public_private_profit, y = n, fill = research_tier_2025)) +
geom_bar(position = "dodge", stat = "identity", width = 0.7) +  # Adjust width for equal bar widths
labs(
title = "Count of Institutions by Type and Research Activity Designation (2025)",
subtitle = "Excludes institutions without a research designation",
x = "Institution Type",
y = "Count of Institutions",
fill = "Research Activity Designation",
caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
scale_x_discrete(labels = c(
"Public" = "Public",
"Private non-profit" = "Private (non-profit)",
"Private for-profit" = "Private (for-profit)"
)) +
scale_y_continuous(limits = c(0, 150), expand = c(0, 0)) +
scale_fill_manual(
values = c(
"Research Colleges and Universities" = "palevioletred",  # Research Colleges stand out
"Research 1: Very High Research Spending and Doctorate Production" = "steelblue",  # R1 color
"Research 2: High Research Spending and Doctorate Production" = "cornflowerblue"  # R2 color
),
labels = c(
"Research Colleges and Universities" = "Research Colleges\nand Universities",
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2"
)
) +
theme(
axis.text.y = element_text(size = 10),
legend.position = "bottom",  # Move the legend to the bottom
legend.box = "horizontal",   # Makes the legend horizontal
legend.title = element_text(size = 12),  # Adding legend title size
axis.text.x = element_text(angle = 0, hjust = 0.5)  # Set x-axis labels to 0 degrees (normal)
)
ggplot(plot_df_clean, aes(x = research_tier_2025, y = n, fill = public_private_profit)) +
geom_bar(position = "dodge", stat = "identity", width = 0.7) +
labs(
title = "Count of Institutions by Research Activity Designation and Type (2025)",
subtitle = "Excludes institutions without a research designation",
x = "Research Activity Designation",
y = "Count of Institutions",
fill = "Institution Type",
caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
scale_x_discrete(labels = c(
"Research Colleges and Universities" = "Research Colleges\nand Universities",
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2"
)) +
scale_y_continuous(limits = c(0, 150), expand = c(0, 0)) +
scale_fill_manual(
values = c(
"Public" = "seagreen",
"Private not-for-profit" = "darkorange",
"Private for-profit" = "saddlebrown"
),
labels = c(
"Public" = "Public",
"Private not-for-profit" = "Private (non-profit)",
"Private for-profit" = "Private (for-profit)"
)
) +
theme(
axis.text.y = element_text(size = 10),
axis.text.x = element_text(angle = 0, hjust = 0.5),
legend.position = "bottom",
legend.box = "horizontal",
legend.title = element_text(size = 12)
)
class_by_count <- ggplot(plot_df_clean, aes(x = research_tier_2025, y = n, fill = public_private_profit)) +
geom_bar(position = "dodge", stat = "identity", width = 0.7) +
labs(
title = "Count of Institutions by Research Activity Designation and Type (2025)",
subtitle = "Excludes institutions without a research designation",
x = "Research Activity Designation",
y = "Count of Institutions",
fill = "Institution Type",
caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
scale_x_discrete(labels = c(
"Research Colleges and Universities" = "Research Colleges\nand Universities",
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2"
)) +
scale_y_continuous(limits = c(0, 150), expand = c(0, 0)) +
scale_fill_manual(
values = c(
"Public" = "seagreen",
"Private not-for-profit" = "darkorange",
"Private for-profit" = "saddlebrown"
),
labels = c(
"Public" = "Public",
"Private not-for-profit" = "Private (non-profit)",
"Private for-profit" = "Private (for-profit)"
)
) +
theme(
axis.text.y = element_text(size = 10),
axis.text.x = element_text(angle = 0, hjust = 0.5),
legend.position = "bottom",
legend.box = "horizontal",
legend.title = element_text(size = 12)
)
class_by_count
# Ensure all combinations of 'public_private_profit' and 'research_tier_2025' are represented
plot_df_clean <- combined_df_na %>%
filter(!is.na(public_private_profit), !is.na(research_tier_2025)) %>%
count(research_tier_2025, public_private_profit) %>%
complete(research_tier_2025, public_private_profit, fill = list(n = 0))  # Fill missing combinations with 0
# Create the plot
ggplot(plot_df_clean, aes(x = public_private_profit, y = n, fill = research_tier_2025)) +
geom_bar(position = "dodge", stat = "identity", width = 0.7) +  # Adjust width for equal bar widths
labs(
title = "Count of Institutions by Type and Research Activity Designation (2025)",
subtitle = "Excludes institutions without a research designation",
x = "Institution Type",
y = "Count of Institutions",
fill = "Research Activity Designation",
caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
scale_x_discrete(labels = c(
"Public" = "Public",
"Private non-profit" = "Private (non-profit)",
"Private for-profit" = "Private (for-profit)"
)) +
scale_y_continuous(limits = c(0, 150), expand = c(0, 0)) +
scale_fill_manual(
values = c(
"Research Colleges and Universities" = "palevioletred",  # Research Colleges stand out
"Research 1: Very High Research Spending and Doctorate Production" = "steelblue",  # R1 color
"Research 2: High Research Spending and Doctorate Production" = "cornflowerblue"  # R2 color
),
labels = c(
"Research Colleges and Universities" = "Research Colleges\nand Universities",
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2"
)
) +
theme(
axis.text.y = element_text(size = 10),
legend.position = "bottom",  # Move the legend to the bottom
legend.box = "horizontal",   # Makes the legend horizontal
legend.title = element_text(size = 12),  # Adding legend title size
axis.text.x = element_text(angle = 0, hjust = 0.5)  # Set x-axis labels to 0 degrees (normal)
)
ggplot(plot_df_clean, aes(x = research_tier_2025, y = n, fill = public_private_profit)) +
geom_bar(position = "dodge", stat = "identity", width = 0.7) +
labs(
title = "Count of Institutions by Research Activity Designation and Type (2025)",
subtitle = "Excludes institutions without a research designation",
x = "Research Activity Designation",
y = "Count of Institutions",
fill = "Institution Type",
caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
scale_x_discrete(labels = c(
"Research Colleges and Universities" = "Research Colleges\nand Universities",
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2"
)) +
scale_y_continuous(limits = c(0, 150), expand = c(0, 0)) +
scale_fill_manual(
values = c(
"Public" = "seagreen",
"Private not-for-profit" = "darkorange",
"Private for-profit" = "saddlebrown"
),
labels = c(
"Public" = "Public",
"Private not-for-profit" = "Private (non-profit)",
"Private for-profit" = "Private (for-profit)"
)
) +
theme(
axis.text.y = element_text(size = 10),
axis.text.x = element_text(angle = 0, hjust = 0.5),
legend.position = "bottom",
legend.box = "horizontal",
legend.title = element_text(size = 12)
)
