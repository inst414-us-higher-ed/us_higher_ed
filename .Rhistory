guides(color = guide_legend(ncol = 3))
# Scatter plot using log10 scales
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.6, size = 1.5) +
scale_color_brewer(palette = "Set2") +
scale_x_log10(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::log_breaks()
) +
scale_y_log10(
breaks = scales::log_breaks()
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Log Scale, Billions USD)",
y = "Avg. Number of Doctoral Degrees\n(Log Scale)",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
legend.key.width = unit(1, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))
# Scatter plot using log10 scales with a lower limit for the y-axis
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.6, size = 2) +
scale_color_brewer(palette = "Set2") +
scale_x_log10(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::log_breaks()
) +
scale_y_log10(
breaks = scales::log_breaks(),
limits = c(1, NA)  # Set the lower limit of y-axis to 1
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Log Scale, Billions USD)",
y = "Avg. Number of Doctoral Degrees\n(Log Scale)",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
legend.key.width = unit(1, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
)
# Clean the spending column (convert to billions)
clean_df_long <- combined_df %>%
mutate(
herd_avg_fy21_to_fy23_billions = herd_avg_fy21_to_fy23 / 1e9  # Convert to billions
)
# Rename tiers for cleaner display
clean_df_long <- clean_df_long %>%
mutate(research_tier_2025 = case_when(
grepl("Research 1", research_tier_2025) ~ "Research 1 (R1)",
grepl("Research 2", research_tier_2025) ~ "Research 2 (R2)",
TRUE ~ "Research Colleges and Universities"
))
# Scatter plot using log10 scales
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.6, size = 1.5) +
scale_color_brewer(palette = "Set2") +
scale_x_log10(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::log_breaks()
) +
scale_y_log10(
breaks = scales::log_breaks()
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Log Scale, Billions USD)",
y = "Avg. Number of Doctoral Degrees\n(Log Scale)",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
legend.key.width = unit(1, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))
# Scatter plot using log10 scales
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.6, size = 1) +
scale_color_brewer(palette = "Set2") +
scale_x_log10(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::log_breaks()
) +
scale_y_log10(
breaks = scales::log_breaks()
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Log Scale, Billions USD)",
y = "Avg. Number of Doctoral Degrees\n(Log Scale)",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
legend.key.width = unit(1, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))
# Scatter plot using log10 scales
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.6, size = 1.2) +
scale_color_brewer(palette = "Set2") +
scale_x_log10(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::log_breaks()
) +
scale_y_log10(
breaks = scales::log_breaks()
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Log Scale, Billions USD)",
y = "Avg. Number of Doctoral Degrees\n(Log Scale)",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
legend.key.width = unit(1, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))
# Scatter plot using log10 scales
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.5 size = 1.2) +
# Scatter plot using log10 scales
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.5, size = 1.2) +
scale_color_brewer(palette = "Set2") +
scale_x_log10(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::log_breaks()
) +
scale_y_log10(
breaks = scales::log_breaks()
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Log Scale, Billions USD)",
y = "Avg. Number of Doctoral Degrees\n(Log Scale)",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
legend.key.width = unit(1, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))
# Scatter plot using log10 scales
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.6, size = 1) +
scale_color_brewer(palette = "Set2") +
scale_x_log10(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::log_breaks()
) +
scale_y_log10(
breaks = scales::log_breaks()
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Log Scale, Billions USD)",
y = "Avg. Number of Doctoral Degrees\n(Log Scale)",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
legend.key.width = unit(1, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))
# Clean the spending column (convert to billions)
clean_df_long <- combined_df %>%
mutate(
herd_avg_fy21_to_fy23_billions = herd_avg_fy21_to_fy23 / 1e9  # Convert to billions
)
# Rename tiers for cleaner display
clean_df_long <- clean_df_long %>%
mutate(research_tier_2025 = case_when(
grepl("Research 1", research_tier_2025) ~ "Research 1 (R1)",
grepl("Research 2", research_tier_2025) ~ "Research 2 (R2)",
TRUE ~ "Research Colleges and Universities"
))
# Scatter plot using log10 scales
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.6, size = 2) +
scale_color_brewer(palette = "Set2") +
scale_x_log10(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::log_breaks()
) +
scale_y_log10(
breaks = scales::log_breaks()
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Log Scale, Billions USD)",
y = "Avg. Number of Doctoral Degrees\n(Log Scale)",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
legend.key.width = unit(1, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))
# Clean the spending column (convert to billions)
clean_df_long <- combined_df %>%
mutate(
herd_avg_fy21_to_fy23_billions = herd_avg_fy21_to_fy23 / 1e9  # Convert to billions
)
# Rename tiers for cleaner display
clean_df_long <- clean_df_long %>%
mutate(research_tier_2025 = case_when(
grepl("Research 1", research_tier_2025) ~ "Research 1 (R1)",
grepl("Research 2", research_tier_2025) ~ "Research 2 (R2)",
TRUE ~ "Research Colleges and Universities"
))
# Filter out rows where y-values are <= 0
clean_df_long_filtered <- clean_df_long %>%
filter(avg_num_doc_degrees_2020_2023 > 0)
# Scatter plot using log10 scales with a lower limit for the y-axis
ggplot(clean_df_long_filtered, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.6, size = 1) +
scale_color_brewer(palette = "Set2") +
scale_x_log10(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::log_breaks()
) +
scale_y_log10(
breaks = scales::log_breaks(),
limits = c(1, NA)  # Set the lower limit of y-axis to 1
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Log Scale, Billions USD)",
y = "Avg. Number of Doctoral Degrees\n(Log Scale)",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
legend.key.width = unit(1, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))
# Scatter plot using log10 scales with a lower limit for the y-axis
ggplot(clean_df_long_filtered, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.6, size = 1.5) +
scale_color_brewer(palette = "Set2") +
scale_x_log10(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::log_breaks()
) +
scale_y_log10(
breaks = scales::log_breaks(),
limits = c(1, NA)  # Set the lower limit of y-axis to 1
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Log Scale, Billions USD)",
y = "Avg. Number of Doctoral Degrees\n(Log Scale)",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
legend.key.width = unit(1, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))
# Scatter plot using log10 scales with a lower limit for the y-axis
ggplot(clean_df_long_filtered, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.6, size = 1.2) +
scale_color_brewer(palette = "Set2") +
scale_x_log10(
labels = scales::label_dollar(scale = 1, suffix = "B"),
breaks = scales::log_breaks()
) +
scale_y_log10(
breaks = scales::log_breaks(),
limits = c(1, NA)  # Set the lower limit of y-axis to 1
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Log Scale, Billions USD)",
y = "Avg. Number of Doctoral Degrees\n(Log Scale)",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
legend.key.width = unit(1, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))
# Clean the spending column (remove $ and commas and convert to numeric)
clean_df_long <- combined_df %>%
mutate(
herd_avg_fy21_to_fy23 = as.numeric(gsub("[$,]", "", herd_avg_fy21_to_fy23)),
herd_avg_fy21_to_fy23_billions = herd_avg_fy21_to_fy23 / 1e9  # Convert to billions
)
# Optional: Rename tiers for cleaner display (if needed)
clean_df_long <- clean_df_long %>%
mutate(research_tier_2025 = case_when(
grepl("Research 1", research_tier_2025) ~ "Research 1 (R1)",
grepl("Research 2", research_tier_2025) ~ "Research 2 (R2)",
TRUE ~ "Research Colleges and Universities"
))
# Scatter plot of research spending vs doctoral degrees
ggplot(clean_df_long, aes(
x = herd_avg_fy21_to_fy23_billions,
y = avg_num_doc_degrees_2020_2023,
color = research_tier_2025
)) +
geom_point(alpha = 0.5, size = 1.5) +
scale_color_brewer(palette = "Set2") +
scale_x_continuous(
labels = scales::label_dollar(scale = 1, suffix = "B"),  # Format in billions
breaks = scales::pretty_breaks(n = 10)  # More breaks on the x-axis
) +
scale_y_continuous(
breaks = scales::pretty_breaks(n = 10)  # More breaks on the y-axis
) +
labs(
title = "Avg. Research Spending vs. Doctoral Degrees (2020–2023)",
x = "Avg. Research Spending (Billions USD)",
y = "Avg. Number of Doctoral Degrees",
color = "Research Tier"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",  # Position the legend below the x-axis
legend.key.width = unit(1, "cm"),  # Adjust the width of the legend keys
legend.key.height = unit(0.5, "cm"),  # Adjust the height of the legend keys
legend.title = element_text(size = 12),
legend.text = element_text(size = 10)
) +
guides(color = guide_legend(ncol = 3))  # Set the legend to 3 columns
# Clean and categorize the data
clean_combined_df <- combined_df_na %>%
mutate(
size_category = case_when(
grepl("very small", size_setting) ~ "Very Small",
grepl("small", size_setting) ~ "Small",
grepl("medium", size_setting) ~ "Medium",
grepl("large", size_setting) ~ "Large",
TRUE ~ NA_character_  # Filter out non-4-year
),
residential_category = case_when(
grepl("highly residential", size_setting) ~ "Highly Residential",
grepl("primarily residential", size_setting) ~ "Primarily Residential",
grepl("primarily nonresidential", size_setting) ~ "Primarily Nonresidential",
TRUE ~ NA_character_
),
research_tier_2025 = factor(
research_tier_2025,
levels = c(
"Research 1: Very High Research Spending and Doctorate Production",
"Research 2: High Research Spending and Doctorate Production",
"Research Colleges and Universities"
)
)
) %>%
filter(!is.na(size_category) & !is.na(residential_category))
# Define label shorteners for x-axis and legend
research_labels <- c(
"Research 1: Very High Research Spending and Doctorate Production" = "R1",
"Research 2: High Research Spending and Doctorate Production" = "R2",
"Research Colleges and Universities" = "Research\nColleges"
)
# Plot: Grouped bar chart faceted by size and residential categories
ggplot(clean_combined_df, aes(x = research_tier_2025, fill = research_tier_2025)) +
geom_bar(position = "dodge") +
facet_grid(size_category ~ residential_category, scales = "free_x") +
scale_x_discrete(labels = research_labels) +
scale_fill_manual(
values = c(
"Research 1: Very High Research Spending and Doctorate Production" = "#1b9e77",
"Research 2: High Research Spending and Doctorate Production" = "#d95f02",
"Research Colleges and Universities" = "#7570b3"
),
labels = research_labels
) +
labs(
title = "Research Tiers by Size and Residential Type (4-Year Universities Only)",
x = "Research Tier",
y = "Number of Institutions",
fill = "Research Tier",
caption = "Note: 'Research Colleges and Universities' are research-focused but do not meet R1 or R2 criteria"
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 0, hjust = .5, size = 10),
axis.text.y = element_text(size = 10),
axis.title = element_text(size = 12),
legend.position = "bottom",
legend.title = element_text(size = 11),
legend.text = element_text(size = 10),
strip.text.x = element_text(size = 11),
strip.text.y = element_text(size = 11),
plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
plot.caption = element_text(size = 9, face = "italic", hjust = 1)
)
